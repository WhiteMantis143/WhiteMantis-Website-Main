"use client";

import React from "react";
import Link from "next/link";
import { usePathname } from "next/navigation";
import { signOut, useSession } from "next-auth/react";


import styles from "./Sidebar.module.css";

export default function Sidebar() {
  const pathname = usePathname();
  const [showLogout, setShowLogout] = React.useState(false);
  const { data: session } = useSession();

  const handleLogout = () => {
    signOut({ callbackUrl: "/" });
  };

  return (
    <>
      <div className={styles.Main}>
        <div className={styles.Sidebar}>
          <div className={styles.Top}>
            <div className={styles.UserName}>
              <h3>{session?.user?.name || "Guest User"}</h3>
            </div>
            <div className={styles.UserEmail}>
              <h5>{session?.user?.email || ""}</h5>
            </div>
          </div>
          <div className={styles.Bottom}>
            <Link href="/account/profile" className={styles.Link}>
              <div
                className={`${styles.Profile} ${pathname === "/account" || pathname === "/account/profile"
                  ? styles.active
                  : ""
                  }`}
              >
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 16 16"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M2.76339 12.5229C3.49828 11.9942 4.27805 11.5761 5.10271 11.2686C5.92737 10.961 6.82018 10.8072 7.78115 10.8072C8.74213 10.8072 9.63494 10.961 10.4596 11.2686C11.2843 11.5761 12.064 11.9942 12.7989 12.5229C13.3698 11.9321 13.829 11.2344 14.1764 10.4298C14.524 9.625 14.6977 8.74213 14.6977 7.78115C14.6977 5.86469 14.0241 4.2328 12.6768 2.88551C11.3295 1.53822 9.69762 0.864573 7.78115 0.864573C5.86469 0.864573 4.2328 1.53822 2.88551 2.88551C1.53822 4.2328 0.864573 5.86469 0.864573 7.78115C0.864573 8.74213 1.03835 9.625 1.38591 10.4298C1.73332 11.2344 2.19248 11.9321 2.76339 12.5229ZM7.78159 8.21344C7.05304 8.21344 6.43855 7.96336 5.9381 7.46321C5.43766 6.96305 5.18744 6.3487 5.18744 5.62016C5.18744 4.89161 5.43751 4.27711 5.93767 3.77667C6.43782 3.27623 7.05218 3.026 7.78072 3.026C8.50927 3.026 9.12376 3.27608 9.62421 3.77624C10.1247 4.27639 10.3749 4.89074 10.3749 5.61929C10.3749 6.34784 10.1248 6.96233 9.62464 7.46278C9.12449 7.96322 8.51013 8.21344 7.78159 8.21344ZM7.78115 15.5623C6.69597 15.5623 5.6801 15.3603 4.73354 14.9562C3.78697 14.5522 2.9634 14 2.2628 13.2995C1.56236 12.5989 1.01011 11.7753 0.606065 10.8288C0.202022 9.88221 0 8.86634 0 7.78115C0 6.69597 0.202022 5.6801 0.606065 4.73354C1.01011 3.78697 1.56236 2.9634 2.2628 2.2628C2.9634 1.56236 3.78697 1.01011 4.73354 0.606065C5.6801 0.202021 6.69597 0 7.78115 0C8.86634 0 9.88221 0.202021 10.8288 0.606065C11.7753 1.01011 12.5989 1.56236 13.2995 2.2628C14 2.9634 14.5522 3.78697 14.9562 4.73354C15.3603 5.6801 15.5623 6.69597 15.5623 7.78115C15.5623 8.86634 15.3603 9.88221 14.9562 10.8288C14.5522 11.7753 14 12.5989 13.2995 13.2995C12.5989 14 11.7753 14.5522 10.8288 14.9562C9.88221 15.3603 8.86634 15.5623 7.78115 15.5623ZM7.78115 14.6977C8.57815 14.6977 9.36239 14.5583 10.1339 14.2795C10.9052 14.0008 11.5719 13.6193 12.1338 13.1348C11.5719 12.6836 10.9218 12.327 10.1836 12.0649C9.44539 11.8028 8.64458 11.6717 7.78115 11.6717C6.91773 11.6717 6.11411 11.8 5.37029 12.0567C4.62662 12.3133 3.97934 12.6727 3.42846 13.1348C3.99044 13.6193 4.65709 14.0008 5.42844 14.2795C6.19992 14.5583 6.98416 14.6977 7.78115 14.6977ZM7.78115 7.34887C8.26661 7.34887 8.6762 7.18208 9.00993 6.8485C9.34351 6.51477 9.5103 6.10518 9.5103 5.61972C9.5103 5.13427 9.34351 4.72467 9.00993 4.39095C8.6762 4.05737 8.26661 3.89058 7.78115 3.89058C7.2957 3.89058 6.88611 4.05737 6.55238 4.39095C6.2188 4.72467 6.05201 5.13427 6.05201 5.61972C6.05201 6.10518 6.2188 6.51477 6.55238 6.8485C6.88611 7.18208 7.2957 7.34887 7.78115 7.34887Z"
                    fill="#6E736A"
                  />
                </svg>
                <p>Profile</p>
              </div>
            </Link>
            <Link href="/account/orders" className={styles.Link}>
              <div
                className={`${styles.Orders} ${pathname.startsWith("/account/orders") ? styles.active : ""
                  }`}
              >
                <svg
                  width="15"
                  height="16"
                  viewBox="0 0 15 16"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M13.9154 3.62996L7.69055 0.125988C7.545 0.0433469 7.38145 0 7.21519 0C7.04893 0 6.88538 0.0433469 6.73984 0.125988L0.514966 3.62996C0.359207 3.71758 0.229224 3.84664 0.138627 4.00363C0.048029 4.16062 0.000149162 4.33977 0 4.52232V11.4779C0.000149162 11.6604 0.048029 11.8396 0.138627 11.9966C0.229224 12.1536 0.359207 12.2826 0.514966 12.3702L6.73984 15.8742C6.88542 15.9567 7.04895 16 7.21519 16C7.38143 16 7.54496 15.9567 7.69055 15.8742L13.9154 12.3702C14.0712 12.2826 14.2012 12.1536 14.2918 11.9966C14.3824 11.8396 14.4302 11.6604 14.4304 11.4779V4.52232C14.4302 4.33977 14.3824 4.16062 14.2918 4.00363C14.2012 3.84664 14.0712 3.71758 13.9154 3.62996ZM7.14445 0.891073C7.16528 0.87936 7.18863 0.873221 7.21236 0.873221C7.2361 0.873221 7.25945 0.87936 7.28027 0.891073L13.1932 4.21832L10.7924 5.56885L4.81366 2.20452L7.14445 0.891073ZM6.79077 14.9091L0.919583 11.6052C0.897889 11.5923 0.879909 11.5737 0.867481 11.5514C0.855053 11.529 0.848622 11.5036 0.848846 11.4779V4.99358L6.79077 8.33901V14.9091ZM1.23719 4.21832L3.93016 2.70197L9.90816 6.0663L7.21519 7.5812L1.23719 4.21832ZM13.5815 11.4779C13.5818 11.5036 13.5753 11.529 13.5629 11.5514C13.5505 11.5737 13.5325 11.5923 13.5108 11.6052L7.63961 14.9091V8.33755L10.1862 6.90411V9.74554C10.1862 9.86127 10.2309 9.97226 10.3105 10.0541C10.3901 10.1359 10.498 10.1819 10.6106 10.1819C10.7231 10.1819 10.8311 10.1359 10.9107 10.0541C10.9903 9.97226 11.035 9.86127 11.035 9.74554V6.42703L13.5815 4.99358V11.4779Z"
                    fill="#6E736A"
                  />
                </svg>
                <p>Orders</p>
              </div>
            </Link>
            <Link href="/account/subscription" className={styles.Link}>
              <div
                className={`${styles.Subscription} ${pathname.startsWith("/account/subscription")
                  ? styles.active
                  : ""
                  }`}
              >
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 16 16"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M7.7138 16C5.73868 16 4.01694 15.3368 2.54857 14.0105C1.0802 12.6843 0.230679 11.0142 0 9H0.98383C1.24823 10.7205 2.01046 12.1507 3.27052 13.2905C4.53058 14.4302 6.01167 15 7.7138 15C9.61045 15 11.2194 14.3208 12.5405 12.9625C13.8617 11.6042 14.5223 9.95 14.5223 8C14.5223 6.05 13.8617 4.39583 12.5405 3.0375C11.2194 1.67917 9.61045 1 7.7138 1C6.70744 1 5.76162 1.21858 4.87635 1.65575C3.99092 2.09292 3.20965 2.69483 2.53252 3.4615H4.94565V4.4615H0.905289V0.30775H1.87793V2.69625C2.62995 1.84742 3.51125 1.18583 4.52182 0.711501C5.53256 0.237167 6.59655 0 7.7138 0C8.79246 0 9.80344 0.208666 10.7467 0.625999C11.6901 1.04333 12.5143 1.6145 13.2195 2.3395C13.9246 3.0645 14.4802 3.91192 14.8861 4.88175C15.292 5.85158 15.495 6.891 15.495 8C15.495 9.109 15.292 10.1484 14.8861 11.1183C14.4802 12.0881 13.9246 12.9355 13.2195 13.6605C12.5143 14.3855 11.6901 14.9567 10.7467 15.374C9.80344 15.7913 8.79246 16 7.7138 16ZM10.8302 11.8538L7.28365 8.20775V3H8.25629V7.79225L11.5183 11.1463L10.8302 11.8538Z"
                    fill="#6E736A"
                  />
                </svg>
                <p>Manage Subscription</p>
              </div>
            </Link>
            {/* <Link href="/account/wishlist" className={styles.Link}>
              <div
                className={`${styles.Wishlist} ${pathname.startsWith("/account/wishlist") ? styles.active : ""
                  }`}
              >
                <svg
                  width="18"
                  height="16"
                  viewBox="0 0 18 16"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M8.7538 16.0038L8.01678 15.3193C6.42942 13.8283 5.11635 12.552 4.07757 11.4905C3.03895 10.4288 2.21909 9.49258 1.61799 8.68175C1.0169 7.87092 0.59696 7.13725 0.358176 6.48075C0.119392 5.82442 0 5.16417 0 4.5C0 3.22817 0.420264 2.16025 1.26079 1.29625C2.10116 0.432083 3.13986 0 4.3769 0C5.23234 0 6.03477 0.225 6.78419 0.675C7.53362 1.125 8.19015 1.7795 8.7538 2.6385C9.31745 1.7795 9.97398 1.125 10.7234 0.675C11.4728 0.225 12.2753 0 13.1307 0C14.3677 0 15.4064 0.432083 16.2468 1.29625C17.0873 2.16025 17.5076 3.22817 17.5076 4.5C17.5076 5.16417 17.3882 5.82442 17.1494 6.48075C16.9106 7.13725 16.4907 7.87092 15.8896 8.68175C15.2885 9.49258 14.4717 10.4288 13.4393 11.4905C12.4068 12.552 11.0907 13.8283 9.49082 15.3193L8.7538 16.0038ZM8.7538 14.65C10.31 13.2038 11.5907 11.9651 12.5957 10.9338C13.6008 9.90225 14.3951 9.00733 14.9787 8.249C15.5623 7.49067 15.9676 6.81892 16.1945 6.23375C16.4215 5.64842 16.535 5.0705 16.535 4.5C16.535 3.5 16.2107 2.66667 15.5623 2C14.9139 1.33333 14.1033 1 13.1307 1C12.3563 1 11.6418 1.22725 10.9872 1.68175C10.3325 2.13625 9.74638 2.8205 9.22894 3.7345H8.27866C7.74873 2.80767 7.15955 2.12017 6.51112 1.672C5.86269 1.224 5.15129 1 4.3769 1C3.41674 1 2.60928 1.33333 1.95453 2C1.29994 2.66667 0.972644 3.5 0.972644 4.5C0.972644 5.0705 1.08612 5.64842 1.31307 6.23375C1.54002 6.81892 1.94529 7.49067 2.52888 8.249C3.11246 9.00733 3.90679 9.899 4.91185 10.924C5.91692 11.949 7.19757 13.191 8.7538 14.65Z"
                    fill="#6E736A"
                  />
                </svg>
                <p>Wishlist</p>
              </div>
            </Link> */}
            <div
              className={styles.Logout}
              onClick={() => setShowLogout(true)}
            >
              <svg
                width="16"
                height="16"
                viewBox="0 0 16 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M1.57131 16C1.12357 16 0.749747 15.8458 0.449848 15.5375C0.149949 15.2292 0 14.8448 0 14.3845V1.6155C0 1.15517 0.149949 0.770833 0.449848 0.4625C0.749747 0.154167 1.12357 0 1.57131 0H7.79988V1H1.57131C1.42152 1 1.2843 1.06408 1.15964 1.19225C1.03497 1.32042 0.972644 1.4615 0.972644 1.6155V14.3845C0.972644 14.5385 1.03497 14.6796 1.15964 14.8077C1.2843 14.9359 1.42152 15 1.57131 15H7.79988V16H1.57131ZM12.1206 11.5385L11.4378 10.8193L13.6936 8.5H5.05021V7.5H13.6936L11.4378 5.18075L12.1206 4.4615L15.5623 8L12.1206 11.5385Z"
                  fill="#6E736A"
                />
              </svg>
              <p>Logout</p>
            </div>
          </div>
        </div>
        {showLogout && (
          <div className={styles.LogoutOverlay}>
            <div className={styles.LogoutPopup}>
              <h2>ARE YOU SURE YOU WANT TO LOGOUT?</h2>
              <p>You can always sign back in to access your specialty coffee profile.</p>

              <div className={styles.LogoutActions}>
                <button
                  className={styles.CancelBtn}
                  onClick={() => setShowLogout(false)}
                >
                  Cancel
                </button>

                <button
                  className={styles.ConfirmBtn}
                  onClick={handleLogout}
                >
                  Logout
                </button>
              </div>
            </div>
          </div>
        )}
      </div>
    </>
  );
}
